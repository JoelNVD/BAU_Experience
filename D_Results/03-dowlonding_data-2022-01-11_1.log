-----------------------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\Users\JOEL\Dropbox\Project_02\DataWork\D_Results/03-dowlonding_data-2022-01-11_1.log
  log type:  text
 opened on:  11 Jan 2022, 10:30:00

.         local today "`c(current_time)'"

.         local curdir "`c(pwd)'"

.         local newn = c(N) + 1

. 
. ********************************************************************************
. *** PART 2: Using Python to download
. ********************************************************************************
. 
. *** 2.1 Short Python code
. python:
----------------------------------------------- python (type end to exit) ---------------------------------------------------------------------------
>>> # Essential Packages
... import seaborn as sns
>>> import re
>>> import os
>>> from urllib.request import urlretrieve
>>> 
>>> # Define path
... os.chdir(r'C:\Users\JOEL\Dropbox\Project_02\DataWork\B_RawData\03-download_data')
>>> 
>>> # Dowloading data
... j = ['SP.POP.TOTL', 'NY.GDP.MKTP.CD', 'GC.XPN.TRFT.ZS']
>>> k = ['SP_POP_TOTL', 'NY_GDP_MKTP_CD', 'GC_XPN_TRFT_ZS']
>>> 
>>> for p in [0,1,2]:
...     url_wb = 'https://api.worldbank.org/v2/en/indicator/'+str(j[p])+'?downloadformat=excel'
...     urlretrieve(url_wb, str(k[p])+'.xls')
('SP_POP_TOTL.xls', <http.client.HTTPMessage object at 0x00000000407E8A60>)
('NY_GDP_MKTP_CD.xls', <http.client.HTTPMessage object at 0x00000000407E8C10>)
('GC_XPN_TRFT_ZS.xls', <http.client.HTTPMessage object at 0x00000000407E8D00>)
>>> end
-----------------------------------------------------------------------------------------------------------------------------------------------------

. 
. ********************************************************************************
. *** PART 3: Excel to .dta
. ********************************************************************************
. 
. *** 3.1 From World Bank
.         local names `" "SP_POP_TOTL" "NY_GDP_MKTP_CD" "GC_XPN_TRFT_ZS" "'

.         qui forval n=1/3{

. 
. *** 3.2 From CEPAL
.         import excel using "${rawdata_3_1}/SPE_CEPAL",clear firstrow
(32 vars, 196 obs)

. 
.         ds y1990-y2019
y1990  y1992  y1994  y1996  y1998  y2000  y2002  y2004  y2006  y2008  y2010  y2012  y2014  y2016  y2018
y1991  y1993  y1995  y1997  y1999  y2001  y2003  y2005  y2007  y2009  y2011  y2013  y2015  y2017  y2019

.         qui foreach k in `r(varlist)'{

. 
.         gen id=_n

.         reshape long y, i(id) j(year)
(j = 1990 1991 1992 1993 1994 1995 1996 1997 1998 1999 2000 2001 2002 2003 2004 2005 2006 2007 2008 2009 2010 2011 2012 2013 2014 2015 2016 2017 2018
>  2019)

Data                               Wide   ->   Long
-----------------------------------------------------------------------------
Number of observations              196   ->   5,880       
Number of variables                  33   ->   5           
j variable (30 values)                    ->   year
xij variables:
                  y1990 y1991 ... y2019   ->   y
-----------------------------------------------------------------------------

.         rename y expenditure

. 
.         save "${rawdata_3_1}/SPE_CEPAL.dta", replace
file C:\Users\JOEL\Dropbox\Project_02\DataWork\B_RawData/03-download_data/SPE_CEPAL.dta saved

. 
. ********************************************************************************
. *** PART 4: Closing log file
. ********************************************************************************
.     log close
      name:  <unnamed>
       log:  C:\Users\JOEL\Dropbox\Project_02\DataWork\D_Results/03-dowlonding_data-2022-01-11_1.log
  log type:  text
 closed on:  11 Jan 2022, 10:30:06
-----------------------------------------------------------------------------------------------------------------------------------------------------
